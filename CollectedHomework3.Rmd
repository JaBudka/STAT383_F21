---
title: "Collected Homework 3"
author: "Jackie Budka, Kristina Franklin, Connor Hathaway"
date: "10/25/2021"
output: html_notebook
---

## Questions
7.6, a-b
7.14
7.20
7.21
7.22

#### Load Packages
```{r}
library(tidyverse)
library(dplyr)
library(Lahman)
library(janitor)
library(babynames)
```



### Question 7.6, a-b
The data set storms is included in the dplyr package. It contains information about 425 tropical storms in the Atlantic.

a. Produce a histogram of the wind speeds in this data set. Fill your bars using the category variable so you can see the bands of color corresponding to the different storm categories.

b. Repeat part (a) but make a histogram of the pressure variable. You should observe that high category storms have low pressure.
```{r }
storms <- dplyr::storms

ggplot(storms, aes(x = wind)) + geom_histogram(aes(fill = category)) +

  labs(title = "Wind Speeds of Storms",

    x = "Storms",

    y = "Wind Speeds",

    fill = "category"

)

```

```{r}

storms <- dplyr::storms

ggplot(storms, aes(x = pressure)) + geom_histogram(aes(fill = category)) +

  labs(title = "Air Pressure of Storms",

    x = "Storms",

    y = "Air Pressures",

    fill = "Category",

)

```

### Question 7.14
Make a scatterplot showing CO2 uptake as a function of concentration level for the built-in data set CO2. Include a smoothed fit line and color by Type. Facet your plot to one plot for each Plant.
```{r }
CO2 <- as_tibble(CO2)
ggplot(CO2, aes(x = conc, y = uptake, color = Type)) +
  geom_point() +
  geom_smooth() +
  facet_wrap(vars(Plant))
```

### Question 7.20
Use the "People" data set from the "Lahman" package.

Create a barplot of the birth months of all players. (Hint: geom_bar())
Create a barplot of the birth months of the players born in the USA after 1970.
#### Part a

```{r barplot of birth months of all players}
People %>%
ggplot(mapping = aes(x = birthMonth)) + geom_bar() + scale_x_discrete(limit = c(1:12)) +
labs(
  title = "Birth Months of All Players",
  x = "Birth Month",
  y = "Number of Players"
)
```

#### Part b
```{r bar plot of birth months of USA players}
People %>%
  filter(birthCountry == "USA", birthYear >= 1970) %>%
ggplot(mapping = aes(x = birthMonth)) + geom_bar() + scale_x_discrete(limit = c(1:12)) +
labs(
  title = "Birth Months of USA Players",
  x = "Birth Month",
  y = "Number of Players"
)
```


### Question 7.21
Make a line graph of the total number of babies of each sex versus year.
```{r }
babyname_count <- tabyl(babynames, year, sex)
View(babyname_count)
bnc_F <- babyname_count %>%
  select(year, F)

bnc_M <- babyname_count%>%
  select(year,M)
  
ggplot() + 
    geom_line(bnc_F,mapping = aes(x = year, y = F, color = "red"))  +   
    geom_line(bnc_M, mapping = aes(x = year, y = M, color = "blue")) + 
    labs(
  title = "Total number of babies of each sex versus year",
  x = "Birth Year",
  y = "Number of Babies") +
  theme(legend.title = element_text(colour="black", size=10, face="bold")) +
  scale_color_manual(labels = c("Female", "Male"), values = c("red", "blue"))
  
```

### Question 7.22
Make a line graph of the number of different names used for each sex versus year.
```{r }
babyname_diff <- select(babynames, year, sex, name)# %>%
  #View(babyname_diff) %>%
as_tibble(babyname_diff)
bb_name <- group_by(babyname_diff, sex, year) 
count(bb_name,name)
#  length(unique(bb_name$name)) 
# ggplot(mapping = aes(x = year, y = )) +
#     geom_line()  +
#     labs(
#   title = "Total number of babies of each sex versus year",
#   x = "Birth Year",
#   y = "Number of Babies") 

```


